package Aes_CTR;

import java.security.InvalidAlgorithmParameterException;
import java.security.InvalidKeyException;
import java.security.NoSuchAlgorithmException;

import javax.crypto.BadPaddingException;
import javax.crypto.Cipher;
import javax.crypto.IllegalBlockSizeException;
import javax.crypto.NoSuchPaddingException;
import javax.crypto.SecretKey;
import javax.crypto.spec.IvParameterSpec;
import javax.crypto.spec.SecretKeySpec;
import javax.xml.bind.DatatypeConverter;

public class AES_CTR {
	public static String tohex(String ascii) {
		StringBuffer buffer = new StringBuffer();
		for (int i = 0; i < ascii.length(); ++i) {
			buffer.append(Integer.toHexString((int) ascii.charAt(i)));
		}
		return buffer.toString();
	}
	public static void main(String[] args) throws NoSuchAlgorithmException, NoSuchPaddingException, InvalidKeyException, InvalidAlgorithmParameterException, IllegalBlockSizeException, BadPaddingException{
		String ct = "1c0111001f010100061a024b535350091817863546727798356425457337821919338675735463468121921928574537";
		String key = "YELLOW SUBMARINE";
		String iv = "109679899893176a";
		final String ivhex = tohex(iv);
		String cthex = tohex(ct);
		String keyhex = tohex(key);
		SecretKeySpec Key = new SecretKeySpec(DatatypeConverter.parseHexBinary(keyhex), "AES");
		IvParameterSpec ivspec = new IvParameterSpec(ivhex.getBytes());
		Cipher cipher = Cipher.getInstance("AES/CTR/NoPadding");
		cipher.init(Cipher.DECRYPT_MODE,Key,ivspec);
		byte[] result = cipher.doFinal(DatatypeConverter.parseHexBinary(cthex));
		System.out.println("Plain text is :"+new String(result));
	}

}
